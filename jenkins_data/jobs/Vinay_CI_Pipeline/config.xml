<?xml version='1.1' encoding='UTF-8'?>
<flow-definition plugin="workflow-job@1546.v62a_c59c112dd">
  <actions>
    <org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobAction plugin="pipeline-model-definition@2.2273.v643f36ed9e94"/>
    <org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobPropertyTrackerAction plugin="pipeline-model-definition@2.2273.v643f36ed9e94">
      <jobProperties/>
      <triggers/>
      <parameters/>
      <options/>
    </org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobPropertyTrackerAction>
  </actions>
  <description></description>
  <keepDependencies>false</keepDependencies>
  <properties/>
  <definition class="org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition" plugin="workflow-cps@4183.v94b_6fd39da_c1">
    <script>pipeline {
    agent any

    environment {
        DOCKERHUB_USER = &apos;vinaymedicherla&apos;   // âœ… Corrected
        IMAGE_NAME = &apos;jenkins&apos;
        BRANCH_NAME = &apos;VINAY_REPO&apos;
    }

    stages {
        stage(&apos;Checkout&apos;) {
            steps {
                git branch: &quot;${BRANCH_NAME}&quot;, 
                    url: &apos;https://github.com/VinayMedicherla/VINAY_REPO.git&apos;,
                    credentialsId: &apos;github-pat&apos;
            }
        }

        stage(&apos;Get Git Tag or Branch&apos;) {
            steps {
                script {
                    def gitTag = sh(script: &quot;git describe --tags --exact-match || true&quot;, returnStdout: true).trim()
                    if (!gitTag) {
                        gitTag = sh(script: &quot;git describe --tags `git rev-list --tags --max-count=1` || true&quot;, returnStdout: true).trim()
                    }
                    if (!gitTag) {
                        gitTag = BRANCH_NAME
                    }
                    echo &quot;âœ… Using tag/branch: ${gitTag}&quot;
                    env.IMAGE_TAG = gitTag
                }
            }
        }

        stage(&apos;Build &amp; Push Docker Image&apos;) {
            steps {
                script {
                    def imageFullName = &quot;${DOCKERHUB_USER}/${IMAGE_NAME}:${IMAGE_TAG}&quot;

                    sh &quot;&quot;&quot;
                        echo &quot;ðŸš€ Building image with tag: ${imageFullName}&quot;
                        docker build -t ${imageFullName} .
                    &quot;&quot;&quot;

                    withCredentials([usernamePassword(credentialsId: &apos;docker-hub-creds&apos;,
                                                      usernameVariable: &apos;DOCKER_USER&apos;,
                                                      passwordVariable: &apos;DOCKER_PASS&apos;)]) {
                        sh &quot;&quot;&quot;
                            echo &quot;${DOCKER_PASS}&quot; | docker login -u &quot;${DOCKER_USER}&quot; --password-stdin
                            docker push ${imageFullName}
                            docker logout
                        &quot;&quot;&quot;
                    }
                }
            }
        }
    }
}
</script>
    <sandbox>true</sandbox>
  </definition>
  <triggers/>
  <disabled>false</disabled>
</flow-definition>